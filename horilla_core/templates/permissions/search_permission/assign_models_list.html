{% load i18n %}
{% for model in all_models %}
    <div class="border-[1px] border-[solid] border-[#efefef] last:border-b-0 px-4 py-2 hover:bg-primary-100">
        <div class="flex gap-2 bulk-permItem">
            <div class="flex items-center">
                <label class="flex items-center">
                    <input
                        type="checkbox"
                        class="bulk-model-select-all w-4 h-4 bg-[#E9EDF7] rounded-sm accent-[#e54f38] mr-2"
                        {% if model.select_all_checked %}checked{% endif %}
                        hx-post="{% url 'horilla_core:bulk_update_user_model_permissions'%}"
                        hx-trigger="change"
                        hx-vals='js:{"model_name": "{{ model.model_name }}", "app_label": "{{ model.app_label }}", "checked": event.target.checked}'
                        hx-on::after-request="$('#reloadMessagesButton').click();toggleBulkChecked($(this));"
                        hx-swap="none"
                    />
                </label>
            </div>
            <div class="w-36 text-sm">
                <div class="w-36 text-sm">
                    {% if model.is_managed %}
                        <button
                            type="button"
                            class="whitespace-nowrap text-left hover:text-primary-600"
                            hx-get="{% url 'horilla_core:model_fields_modal_bulk' model.app_label model.model_name %}?context=bulk"
                            hx-vals='js:{"selected_user_ids": getSelectedUserIds()}'
                            hx-target="#modalBox"
                            hx-swap="innerHTML"
                            onclick="openModal()"
                        >
                            {{ model.verbose_name }}
                        </button>
                    {% else %}
                        <div class="relative group inline-block cursor-pointer">
                            <span class="whitespace-nowrap text-gray-400 ">
                                {{ model.verbose_name }}
                            </span>
                            <span class="min-w-max z-40 absolute h-auto py-[3px] px-[15px] left-[40px] top-0 bg-[#000000] text-[.7rem] rounded-[5px] text-white opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none">
                                {% trans 'Field permissions not available for this model' %}
                            </span>
                        </div>
                    {% endif %}
                </div>
            </div>
            <div class="flex gap-5 text-xs text-dark-300">
                {% for perm in model.permissions %}
                    <label class="flex items-center whitespace-nowrap">
                        <input
                            type="checkbox"
                            name="permissions"
                            value="{{ perm.id }}"
                            class="bulk-individual-perm w-4 h-4 border border-[#cfcfcf] rounded-sm accent-[#e54f38] mr-2"
                            {% if perm.has_perm %}checked{% endif %}
                            />
                        {{ perm.label }}
                    </label>
                {% endfor %}
            </div>
        </div>
    </div>
{% empty %}
    <div class="px-4 py-8 text-center text-gray-500">
        {% if search_query %}
            {% trans "No models found matching your search." %}
        {% else %}
            {% trans "No models available." %}
        {% endif %}
    </div>
{% endfor %}
